# 事件分发

activity-phonewindow-decorview-viewgroup-view



# LifeCycle

## 原理

ComponentActivity中实现LifecycleOwner接口并制造LifecycleRegistry监听器,onCreate中添加ReportFragment,通过 **监听ReportFrament的生命周期变化(API<29) ** 或**直接注册ActivityLifecycleCallbacks(API>=29) ** 的方式,通过ReportFragment的dispatch()方法,最终通知LifecycleRegistry回传给各个观察者Activity的生命周期变化

### 为什么使用fragment监听生命周期

activity可能存在fragment,而fragment是依附于Activity的,所以会在创建时 在activity之后执行对应的生命周期方法,在销毁时先于activity执行对应的生命周期方法 

展开来说就是fragment的onCreate onStart onResume,方法在Activity的对应方法之后执行的,可以保证观察者收到消息时 fragment和Activity都已经执行完了对应的状态下的代码逻辑,此时观察者再去执行代码逻辑 就是对应状态下的最后代码逻辑了

反过来fragment的onPause onStop onDestory 都是在Activity对应生命周期方法之前执行的,可以保证观察者在Activity要执行这些状态变化的第一时间做出相应的代码逻辑

