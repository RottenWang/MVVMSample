### HTTP原理和工作机制

#### 1.Http是什么 

用于传输超文本的协议 

HyperText Transfer Protocol超文本传输协议

超文本:在电脑中显示的,含有可以指向其他文本的链接的文本 就是HTML(文档的格式) 以及web api的数据

#### 2.HTTP的工作方式

浏览器 ->发送请求->服务器 , 服务器->响应->浏览器渲染

URL组成 http://github.com/user?gender=male

​         协议类型  服务器地址              路径

请求报文:

请求行(request line)  GET(请求方法method)  /user?gender=male(path)  HTTP/1.1(HTTP version)

 请求头(header)          HOST:github.com

​									 Content-Type:text/plain

请求体(body)              dadsfadfasdfdasf

响应报文:

状态行(响应行)  HTTP/1.1 200(status code) OK(code的简单描述)

响应头  Server:nginx/1.13.3

​			  content-Type:text/plain

响应体  [{"a":"b"},{}]



##### (1)请求的方法 Request Methods

GET 获取资源 没有body(可以有 但是做法不规范)

POST 增加或修改资源 有body

PUT  修改资源 有body

DELETE 删除资源 没有body 

HEAD 和get几乎一样 区别在于服务器不会返回body

get 和 put delete 都是幂等的 也就是说执行一次或多次结果 是一样的

##### (2)状态吗 status code

对结果做出类型化描述(如 成功 内容未找到)

为什么区分状态码:方便开发调试

1xx: 临时性消息  100 101告诉客户端我支持http2 不支持返回200

2xx: 成功

3xx: 重定向 301 永久迁移 302 临时迁移 一般都是301

4xx: 客户端错误

5xx: 服务器错误

##### (3) header

HTTP消息的元数据(metadata:数据的数据 或者说是数据的属性)

 Host:服务器主机地址  但是不是用来寻址的  在请求之前就已经通过DNS寻址了

作用:可能多个服务器主机地址是同一个IP 服务器需要做出判断所以需要携带HOST

 Content-Length:内容的长度(字节) 确定内容的长度(二进制内容)

 Content-Type/body的类型

​	text/html HTML文本,用于浏览器页面响应或post put请求

​	application/json json形式 用于web Api的响应

​	application/x-www-form-urlencoded 普通表单 encoded URL格式

​	multipart/form-data;boundary=----WebKitFormBoundary12938192ASDFA 多部分形式,一般用于传输包含二进制内容的多项内

​    image/jpeg  application/zip 提交单文件

Transfer-Encoding: chunked  分块传输 表示body长度无法确定,Content-Length不能使用

Location : https://www.baidu.com/ 重定向的目标URL
User-Agent: 用户代理 表示是浏览器 还是手机 标识等

Range/Accept-Range:断点续传 或分段下载

​	Accept-Range :bytes 表示支持分段下载

​	Range:bytes=0-15000 表示下载的范围

Cookie/Set-Cookie:发送Cookie/设置Cookie

Authorization:授权信息

Accept:客户端能接受的数据类型,如text/html;text/json

Accept-Charset:客户端接受的字符集,如utf-8

Accept-Encoding:客户端接受的压缩编码类型 如gzip

Content-Encoding;压缩类型,如gzip

Cache:Cache和Buffer的区别  cache缓存 buffer缓冲

 cache可能会重复使用

 buffer是针对工作流的 上游产生太快的缓冲等 在线播放提前下载进度是缓冲

​	Cache-Control :no-cache 可以缓存但需要先询问,no-store 不要缓存 max-age 失效日期前可以缓存

​	Last-Modified : Fri , 12 May 2006 18:53:33 GMT 去问服务器 在这个日期后 有改动吗 

​	Etag:If-None-Match 类似hash 标签 询问服务器最新资源是否还是这个tag

​	Cache-Control:private/public  告诉中间节点是否需要缓存 private不缓存 public可以缓存

#### 3.REST

是一种架构风格

RESTful HTTP 正确使用HTTP 

GET POST PUT DELETE 等正确的使用 



### 编码 加密 Hash 序列和字符集

#### 密码学

​	起源:古代战争  移位式加密:密码棒  替换式加密:替换文字 码表一一映射

#### 现代密码学

不止可以用于文字内容,还可以用于各种二进制数据

​	对称加密: 原数据 ->加密算法+密钥 -> 密文 ->解密算法+密钥->原数据

​		经典算法:DES(密钥短被逐渐弃用),AES



​	非对称加密: 原数据-> 加密算法+公钥->密文->加密算法+私钥->原数据

​	原理:使用公钥对数据进行加密得到密文,使用私钥对数据解密得到原数据

​		经典算法:RSA (加密解密都可以) DSA(签名专用) 问:公钥能不能解私钥加密的密文:能 但是公钥和私钥不能换 因为公钥可以被计算出来

​		延伸用途:数字签名与验证

​		原数据使用私钥加密后 发送签名数据和原数据 然后通过公钥加密 得到后比对原数据

​		原数据 -> 加密算法+私钥->签名数据-> 加密算法+公钥->原数据

加密+签名

对原数据用对方公钥加密得到密文 用自己私钥加密得到签名数据 发送给对方,对方使用自己的私钥加密得到原数据,用对方公钥验证得到原数据 比对两个数据是否一致

数据可能会很大 所以一般取原数据的hash值去进行验证签名

#### 密码学密钥和登录密码

密钥(key)   

场景:用于加密和解密

目的:保证数据被盗时不会被人读懂内容

焦点:数据

登录密码(password) 

场景: 用户进入网站或游戏前的身份验证

目的:数据提供方或应用服务方对帐号拥有者数据的保护,保证 [你是你] 的时候才提供权限

焦点:身份

#### Base64 

将二进制数据转换成由64个字符组成的字符串的编码算法

64个字符(a-zA-Z0-9+/)

什么是二进制数据:非文本数据就是二进制数据 广义:所有的数据都是二进制数据

用途:

​	让原数据具有字符串所具有的特性,如可以放在URL中传输,可以保存到文本文件,可以通过普通的聊天软件进行文本传输

​	把原本人烟可以读懂的字符串变成读不懂的字符串,降低偷窥风险

Base64加密传输图片,可以更安全和高效吗? 不安全也不高效

变种:Base58 去掉了几个字符 使用的地方 加密货币地址

##### URL encoding (Base64变种)

将URL中的保留字符使用百分号% 进行编码

目的:消除歧义,避免解析错误比如& / + 进行百分号编码 消除歧义

#### 压缩与解压缩

压缩:把数据换一种方式来存储,以减小存储空间

解压缩:把压缩后的数据还原成原先的形式,以便使用

常见压缩算法:DEFLATE(ZIP) JPEG(图片压缩) MP3(音乐)

压缩数据编码吗? 压缩数据是编码的一种

​	编码到底是什么意思? 按照一定规则将数据进行更改 编码后数据不会损失

##### 媒体数据的编解码

什么是图片 音频 视频的编解码

图片的编码:把图像数据写成 JPG PNG等文件的编码格式

图片的解码:把JPG,PNG等文件中的数据解析成标准的图像数据

音频 视频的编解码 和图片一样  有损压缩 无损压缩 

##### 序列化

序列化:把数据对象(一般是内存中的,例如JVM中的对象) 转换成字节序列的过程

反序列化:把字节序列重新转换成内存中的对象

目的:让内存中的对象可以被存储和传输

序列化是编码吗:严格来说不是

##### Hash(不可逆)

定义:把任意数据转换成指定大小范围(通常很小)的数据

作用:摘要,数字指纹

经典算法:MD5 SHA1 SHA256等

实际用途:

​	1.数据完整性验证:对原文件提供hash值 提供验证文件未被篡改

​	2.快速查找:hashCode() 和 HashMap hashCode会影响HashMap的存储

​	HashMap会去找key对应的hashcode的内存地址是否有数据 所以需要重写hashcode()方法 

​	hashcode是寻址用,equals是比较用 

​	3.隐私保护

Hash是编码吗?

不是,因为数据无法还原

Hash是加密吗?据说MD5是 不可逆加密

不是,加密是可以逆转的  

##### 字符集

含义:一个由整数向现实世界中的文字符号的Map

分支: 

ASCII  128个字符 1字节

ISO-8859-1 对ASCII进行扩充 1字节

​	Unicode	->UTF-8 UTF-16 同一字符集不同编码

GBK GB2312 GB19030 中国自研标准,多字节,字符集+编码



### 登录与授权 HTTPS和TCP/IP协议族

#### 登录和授权

Cookie

Cookie的工作机制

服务器需要保存的信息发送给客户端 客户端直接存储

response中有Set-Cookie的header保存服务器发送的header内容 客户端的request中使用Cookie的header 发送上次保存的header内容

Cookie的作用

​	会话管理:登录状态,购物车

​	个性化:用户偏好,主题
​	Tracking:分析用户行为

XSS(Cross-site scripting):HttpOnly  set-Cookie:sessionid=1;HttpOnly跨站脚本攻击

XSRF(Cross-site request forgery):Referer:www.google.com 跨站请求伪造

Authorization

Basic :Authorization:Basic 

Bearer:Authorization:Bearer token

​	OAuth2

​		OAuth2流程

​		微信登录就是一个完整的OAuth2流程

自家App中使用Bearer token 简化版的OAuth2流程

refresh_token

#### TCP/IP协议族

一系列协议所组成的一个网络分层模型

为什么要分层 因为网络不稳定

HTTP TCP IP LINK 

具体分层: 

​	Application Layer 应用层:HTTP FTP DNS

​	Transport Layer 传输层:TCP UDP

​	Internet Layer 网络层:IP

​	Link Layer 数据链路层: 以太网 Wi-Fi

#### TCP连接

什么叫做连接

TCP连接的建立和关闭 三次握手

长连接

​	为什么要长连接

​	长连接的实现方式:心跳

#### HTTPS

 HTTP over SSL

SSL :Secure Socket Layer -> TLS Transport Layer Secure

定义:在HTTP之下增加的一个安全层,用于保障HTTP的加密传输

本质:在客户端和服务器之间协商出一个对称密钥,每次发送信息之前将内容加密,收到之后解密,达到内容的加密传输

为什么不直接用非对称加密? 太耗时



